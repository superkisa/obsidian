[Mask Region based Convolution Neural Networks - EXPLAINED!](https://www.youtube.com/watch?v=4tkgOzQ9yyo)
[Mask R-CNN: архитектура современной нейронной сети для сегментации объектов на изображениях](https://habr.com/ru/articles/421299/)
![[Pasted image 20240110143208.png]]
Решает проблему мгновенной сегментации: выделение каждого объекта, который представляет важное значение.
Мгновенная сегментация разделена на 2 подзадачи:
	1. Обнаружение объекта
	2. Семантическая сегментация
![[Pasted image 20240110200030.png]]
![[Pasted image 20240110200051.png]]
Эти две задачи дают мгновенную сегментацию. 
![[Pasted image 20240110200200.png]]

## **Архитектура**
Для обнаружения объектов используют Faster R-CNN.
Для семантической сегментации используют FCN.
FCN классифицирует изображения на уровне пикселей, тем самым решая проблему семантической сегментации на семантическом уровне. В отличие от классического CNN, который использует полностью связанный уровень для получения вектора признаков фиксированной длины для классификации после сверточного уровня (полный уровень соединения + выход softmax), FCN может принимать входные изображения любого размера и использовать уровень деконволюции для последнего уровня свертки.
![[Pasted image 20240110210928.png]]
Rol Pooling не позволяет охватить всю область, что приводит не только к потере данных, но может привести и к смещению. Очевидно, если ядро фильтра при сканировании не выходит за пределы изображения, размерность карты признаков будет меньше, чем у исходной картинки. Если нужно сохранить тот же размер, применяют так называемые paddings — значения, которыми дополняется изображение по краям и которые потом захватываются фильтром вместе с реальными пикселями картинки.
![[Pasted image 20240110234826.png]]
Пример смещения
![[Pasted image 20240110235848.png]]
Выделение маски происходит в class-agnostic стиле: маски предсказываются отдельно для каждого класса, без предварительного знания, что изображено в регионе, и потом просто выбирается маска класса, победившего в независимом классификаторе. Утверждается, что такой подход более эффективен, чем опирающийся на априорное знание класса.  
  
Одна из основных модификаций, возникших из-за необходимости предсказывать маску — изменение процедуры **RoIPool**(вычисляющей матрицу признаков для региона-кандидата) на так называемую **RoIAlign**. Дело в том, что карта признаков, полученная из CNN, имеет меньший размер, чем исходное изображение, и регион, охватывающий на изображении целочисленное количество пикселей, не получается отобразить в пропорциональный регион карты с целочисленным количеством признаков:
![[Pasted image 20240111003906.png]]

В RoIPool проблема решалась просто округлением дробных значений до целых. Такой подход нормально работает при выделении охватывающей рамки, но вычисленная на основе таких данных маска получается слишком неточной.  
  
В противоположность этому, в RoIAlign не используется округление, все числа остаются действительными, а для вычисления значений признаков используется билинейная интерполяция по четырём ближайшим целочисленным точкам.  
  
В оригинальном документе разница поясняется таким рисунком:
![[Pasted image 20240111003934.png]]

Здесь штрихованной сеткой обозначена карта признаков, а непрерывной — отображение на карту признаков региона-кандидата с исходной фотографии. В данный регион должно попасть 4 группы для max pooling по 4 признака, обозначенных на рисунке точками. В отличие от процедуры RoIPool, которая за счёт округления просто бы выровняла регион по целочисленным координатам, RoIAlign оставляет точки в их текущих местах, но вычисляет значения каждой из них при помощи билинейной интерполяции по четырём ближайшим признакам.
![[Pasted image 20240111004040.png]]
Информация не теряется, так как нет квантования.


![[Pasted image 20240111000532.png]]
![[Pasted image 20240111000546.png]]
![[Pasted image 20240111000600.png]]


Используем полные свёрточные сети - не теряем информацию об объектах.
![[Pasted image 20240111001435.png]]
Проблема FCIS - перекрытие объектами
![[Pasted image 20240110234650.png]]

### Дополнительно
P.S. Прикрепляю годную презентацию
![[06_SemanticSegmentation_Rus_pptx.pdf]]
